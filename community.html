<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Community - Numigos</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="script.js" defer></script>
    <!-- Auth Script -->
    <script src="auth.js" defer></script>
    <!-- Mobile Menu Script -->
    <script src="mobile-menu.js" defer></script>
    <style>
        /* Mobile first styles */
        .app-layout {
            display: flex;
            flex-direction: column;
            gap: 2rem;
            padding: 1rem 0;
        }
        
        .sidebar {
            width: 100%;
            order: 2;
            display: none; /* Hidden by default on mobile */
        }
        
        .sidebar.active {
            display: block;
        }
        
        .main-content {
            width: 100%;
            order: 1;
        }
        
        .sidebar-toggle {
            display: block;
            width: 100%;
            padding: 0.75rem;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: var(--radius-sm);
            margin-bottom: 1rem;
            cursor: pointer;
            font-size: 1rem;
        }
        
        .community-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1rem;
        }
        
        .community-card {
            border: 1px solid var(--border-color);
            border-radius: var(--radius-sm);
            overflow: hidden;
            transition: transform 0.2s;
        }
        
        @media (min-width: 768px) {
            .app-layout {
                flex-direction: row;
                align-items: flex-start;
            }
            
            .sidebar {
                width: 280px;
                position: sticky;
                top: 100px;
                display: block !important;
            }
            
            .main-content {
                flex: 1;
            }
            
            .sidebar-toggle {
                display: none;
            }
            
            .community-grid {
                grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            }
        }
        
        .sidebar-nav-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem 1rem;
            background-color: var(--white);
            color: var(--text-light);
            border-radius: var(--radius-sm);
            font-weight: 500;
            margin-bottom: 0.5rem;
        }

        .sidebar-nav-item.active {
            background-color: #FFF7ED;
            color: var(--primary-color);
            border: 1px solid #FFEDD5;
        }

        .sidebar-section {
            background: var(--white);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-sm);
            margin-bottom: 1rem;
        }
    </style>
</head>

<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="container nav-container">
            <a href="index.html" class="logo">numigos</a>
            <button class="mobile-menu-btn" aria-label="Toggle navigation">
                <span></span>
                <span></span>
                <span></span>
            </button>
            <div class="nav-links">
                <a href="blog.html">Blog</a>
                <a href="community.html" style="color: var(--text-dark);">Community</a>
                <!-- Auth links will be added dynamically by auth.js -->
            </div>
        </div>
    </nav>

    <div class="container app-layout">
        <!-- Mobile Toggle Button for Sidebar -->
        <button class="sidebar-toggle" id="sidebarToggle">‚ò∞ Menu</button>
        
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <a href="community.html" class="sidebar-nav-item active">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round">
                    <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                    <polyline points="9 22 9 12 15 12 15 22"></polyline>
                </svg>
                Home
            </a>

            <div class="sidebar-section">
                <div class="dropdown-header">
                    JOINED COMMUNITY
                </div>
                <!-- Logic in JS will populate this with standard items -->
                <div id="sidebar-joined-list"
                    style="display: flex; flex-direction: column; gap: 0.5rem; padding: 0.5rem;">
                    <!-- JS Populates -->
                </div>
            </div>

            <button class="btn btn-primary full-width-btn" onclick="openCreateCommunityModal()">+ Create
                Community</button>
            <button class="btn btn-outline full-width-btn" onclick="openCreateEventModal()"
                style="margin-top: 0.75rem; background:white;">+ Create
                Event</button>
        </aside>

        <!-- Main Content -->
        <!-- Main Content -->
        <main class="main-content">
            <div id="home-view">
                <!-- Events Section -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Upcoming Events</h3>
                    </div>
                    <div class="events-list">
                        <!-- Event 1 -->
                        <div class="event-card">
                            <img src="https://images.unsplash.com/photo-1517694712202-14dd9538aa97?ixlib=rb-4.0.3&w=400&q=80"
                                class="event-image" alt="Coding">
                            <div class="event-details">
                                <h4>Winter Coding Bootcamp</h4>
                                <div class="event-meta">
                                    <span>üìÖ Dec 24 ‚Ä¢ 10:00 AM</span>
                                    <span>üìç Lab 4 ‚Ä¢ CS Society</span>
                                </div>
                            </div>
                        </div>
                        <!-- Event 2 -->
                        <div class="event-card">
                            <img src="https://images.unsplash.com/photo-1485827404703-89b55fcc595e?ixlib=rb-4.0.3&w=400&q=80"
                                class="event-image" alt="Robotics">
                            <div class="event-details">
                                <h4>Robotics Seminar</h4>
                                <div class="event-meta">
                                    <span>üìÖ Dec 28 ‚Ä¢ 02:00 PM</span>
                                    <span>üìç Auditorium ‚Ä¢ Robotics Club</span>
                                </div>
                            </div>
                        </div>
                        <!-- Event 3 -->
                        <div class="event-card">
                            <img src="https://images.unsplash.com/photo-1544531586-fde5298cdd40?ixlib=rb-4.0.3&w=400&q=80"
                                class="event-image" alt="Art">
                            <div class="event-details">
                                <h4>Art Exhibition Opening</h4>
                                <div class="event-meta">
                                    <span>üìÖ Dec 30 ‚Ä¢ 05:00 PM</span>
                                    <span>üìç Main Hall ‚Ä¢ Arts Club</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- All Communities Section -->
                <div class="card" style="border:none; padding:0;">
                    <div class="card-header">
                        <h3 class="card-title">All Communities</h3>
                    </div>
                    <div class="community-grid">
                        <!-- Loaded via JS -->
                    </div>
                </div>
            </div>

            <!-- Detail View Placeholder (Hidden by default) -->
            <div id="community-detail-view" style="display: none;">
                <!-- Filled by JS -->
            </div>
        </main>
    </div>

    <!-- Create Community Modal (Improved) -->
    <div class="modal-overlay" id="create-community-modal">
        <div class="modal" style="border-radius: 16px; max-width: 500px; width: 95%; padding: 0;">
            <div class="modal-header" style="border-bottom: 1px solid #eee; padding: 1.5rem;">
                <h3 class="modal-title" style="font-size: 1.5rem;">Create Community</h3>
                <button class="close-modal" onclick="closeCreateCommunityModal()"
                    style="font-size: 2rem;">&times;</button>
            </div>
            <form onsubmit="handleCreateCommunity(event)" style="padding: 1.5rem;">
                <div class="form-group">
                    <label class="form-label" style="font-weight: 500; margin-bottom: 0.5rem;">Community Name</label>
                    <input type="text" class="form-input" placeholder="e.g. Hiking Club"
                        style="font-size: 1.1rem; padding: 0.8rem; border-radius: 8px; border: 1px solid #E5E7EB;"
                        required>
                </div>

                <div class="form-group">
                    <label class="form-label" style="font-weight: 500; margin-bottom: 0.5rem;">Description</label>
                    <textarea class="form-input" rows="3" placeholder="What is this community about?"
                        style="padding: 0.8rem; border-radius: 8px; border: 1px solid #E5E7EB;" required></textarea>
                </div>

                <div class="form-group">
                    <label class="form-label" style="font-weight: 500; margin-bottom: 0.5rem;">Cover Image</label>
                    <div id="comm-file-upload-area" class="file-upload-area">
                        <div class="file-upload-text">
                            <span style="font-size: 2rem;">üì∑</span>
                            <p style="margin-top: 0.5rem; color: #6B7280;">Click or drop image here</p>
                        </div>
                        <img id="comm-image-preview" class="file-preview" src="" alt="Preview">
                        <input type="file" id="comm-image-file" accept="image/*" style="display: none;">
                    </div>
                </div>

                <button type="submit" class="btn btn-primary"
                    style="width: 100%; padding: 1rem; border-radius: 8px; font-weight: 600;">Create
                    Community</button>
            </form>
        </div>
    </div>

    <!-- Create Event Modal -->
    <div class="modal-overlay" id="create-event-modal">
        <div class="modal" style="border-radius: 16px; max-width: 500px; width: 95%; padding: 0;">
            <div class="modal-header" style="border-bottom: 1px solid #eee; padding: 1.5rem;">
                <h3 class="modal-title" style="font-size: 1.5rem;">Create Upcoming Event</h3>
                <button class="close-modal" onclick="closeCreateEventModal()" style="font-size: 2rem;">&times;</button>
            </div>
            <form onsubmit="handleCreateEvent(event)" style="padding: 1.5rem;">
                <div class="form-group">
                    <label class="form-label" style="font-weight: 500; margin-bottom: 0.5rem;">Event Title</label>
                    <input type="text" class="form-input" id="event-title" placeholder="e.g. Winter Coding Bootcamp"
                        style="font-size: 1.1rem; padding: 0.8rem; border-radius: 8px; border: 1px solid #E5E7EB;"
                        required>
                </div>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                    <div class="form-group">
                        <label class="form-label" style="font-weight: 500; margin-bottom: 0.5rem;">Date</label>
                        <input type="date" class="form-input" id="event-date"
                            style="padding: 0.8rem; border-radius: 8px; border: 1px solid #E5E7EB;" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label" style="font-weight: 500; margin-bottom: 0.5rem;">Time</label>
                        <input type="time" class="form-input" id="event-time"
                            style="padding: 0.8rem; border-radius: 8px; border: 1px solid #E5E7EB;" required>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label" style="font-weight: 500; margin-bottom: 0.5rem;">Place / Location</label>
                    <input type="text" class="form-input" id="event-place" placeholder="e.g. Lab 4 or Zoom"
                        style="padding: 0.8rem; border-radius: 8px; border: 1px solid #E5E7EB;" required>
                </div>

                <!-- Image Upload for event (optional) to make it beautiful -->
                <div class="form-group">
                    <label class="form-label" style="font-weight: 500; margin-bottom: 0.5rem;">Event Image</label>
                    <div id="event-file-upload-area" class="file-upload-area">
                        <div class="file-upload-text">
                            <span style="font-size: 2rem;">üì∑</span>
                            <p style="margin-top: 0.5rem; color: #6B7280;">Click or drop image here</p>
                        </div>
                        <img id="event-image-preview" class="file-preview" src="" alt="Preview">
                        <input type="file" id="event-image-file" accept="image/*" style="display: none;">
                    </div>
                </div>

                <button type="submit" class="btn btn-primary"
                    style="width: 100%; padding: 1rem; border-radius: 8px; font-weight: 600;">Create Event</button>
            </form>
        </div>
    </div>

    <script>
        // Toggle mobile sidebar
        document.addEventListener('DOMContentLoaded', function() {
            const sidebarToggle = document.getElementById('sidebarToggle');
            const sidebar = document.getElementById('sidebar');
            
            if (sidebarToggle && sidebar) {
                sidebarToggle.addEventListener('click', function() {
                    sidebar.classList.toggle('active');
                });
            }
            
            // Close sidebar when clicking outside
            document.addEventListener('click', function(event) {
                if (!event.target.closest('.sidebar') && !event.target.closest('.sidebar-toggle')) {
                    sidebar.classList.remove('active');
                }
            });
        });
    </script>
</body>
</html>